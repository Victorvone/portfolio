<!DOCTYPE HTML>
<html>
	<head>
		<title>Deployment and automation</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<a href="index.html" class="logo">Portfolio</a>
					</header>

				<!-- Nav -->
					<nav id="nav">
						<ul class="links">
							<li><a href="index.html">Portfolio</a></li>
							<li class="active"><a href="MLOps.html">Deployment and automation</a></li>
						</ul>
						<ul class="icons">
              <li><a href="https://www.linkedin.com/in/victor-von-eisenhart-rothe/" class="icon brands fa-linkedin"><span class="label">Instagram</span></a></li>
							<li><a href="https://github.com/Victorvone" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">

						<!-- Post -->
							<section class="post">
								<header class="major">
									<span class="date">December, 2022</span>
									<h1>Deploying a prediction model and automating it's lifecycle</h1>
									<p>In this project I deployed a neural network predicting taxiprices. This consisted of  training and storing it via the cloud, automating and monitoring it's lifecycle and making it accessible via Docker and FastAPI. </p>
								</header>
								<div class="image main"><img src="images/MLOps_stack.png" alt="" /></div>
								<p>The goal of this project was to bring a provided neural network predicting the price of a taxi fare into production, being able to train it on a big data set (55M rows) and to automate itâ€™s lifecycle.
                  The project constituted of the following steps:
                  <ol>
                    <li>Package the code - mplementing the code of a provided notebook through setting up  a python package that can be ran via command and deployed.
                    </li>
                    <li>Implement incremental processing and incremental learning - To circumvent memory and time
                      constraints, I implemented chunk by chunk preprocessing and partial fitting of the model.
                    <a class="image fit"><img src="images/IncrementalProcessingFit.png" alt="" /></a>
                    </li>
                    <li>Cloud training - Sourcing data from a warehouse using Google Bigquery and training as well as
                      evaluating and using the model from a virtual machine using Google Compute Engine. </li>
                    <li>Automating the model lifecycle - To ensure reliability over time, I used MLflow
                      to store the trained models and monitor their performance over time in the cloud.
                      Consequently, I implemented Prefect to automate a workflow that preprocesses new data,
                      evaluates the performance of the current model on the new data and
                      trains it on the new data to see how the perfoemance changes.

                    </li>
                    <li>Deployment - Lastly, I created a Dockerimage, pushed it to Google Cloud Run and built a
                      prediction API using FastAPI to enable the use of the model via API requests.<br>
                      Example API request:<br>
                      ".../predict?pickup_datetime=2013-07-06%2017:18:00<br>
                      &pickup_longitude=-73.950655<br>
                      &pickup_latitude=40.783282<br>
                      &dropoff_longitude=-73.984365<br>
                      &dropoff_latitude=40.769802<br>
                      &passenger_count=2"<br><br>

                      Example response:
                      <a class="image fit"><img src="images/API_response.png" alt="" /></a>
                    </li>
                  </ol>
                  As this project is part of an official cooperation with an external party, I cannot make the whole repository publicly available.
                  However, I am happy to share with you some excerpts of the code I wrote for it.
                  <br> <br>
                  <ul>
                   <h3>Tech stack</h3>
                      <li>Python</li>
                      <li>MLflow</li>
                      <li>Google Cloud Run</li>
                      <li>Google Bigquery</li>
                      <li>Google Compute Engine</li>
                      <li>Google Prefect</li>
                      <li>Google Docker</li>
                      <li>Google FastAPI</li>
                  </ul>
                    <br> <br>

                  <h3>Code excerpts</h3>
                  <br>

                  Incremental processing and training:
                  <a class="image fit"><img src="images/ChunkPreprocessing.png" alt="" /></a>
                  <a class="image fit"><img src="images/ChunkTraining.png" alt="" /></a><br>

                  MLflow and Prefect:
                  <a class="image fit"><img src="images/MLflowPrefectCodeSnippet1.png" alt="" /></a>
                  <a class="image fit"><img src="images/MLflowPrefectCodeSnippet2.png" alt="" /></a><br>

                  FastAPI:
                  <a class="image fit"><img src="images/FastAPI.png" alt="" /></a>
                </p>

							</section>

					</div>

				<!-- Footer -->
				<footer id="footer">
          <section class="split contact">
            <section class="alt">
              <div style="display:flex; justify-content: space-between;">
                <div>
                  <h3>Location of residence</h3>
                  <p>Berlin, Germany</p>
                </div>
                <div>
                  <h3>Email</h3>
                  <p><a href="victorvoneisenhart@gmail.com">victorvoneisenhart@gmail.com</a></p>
                </div>
                <div>
                  <h3>Social</h3>
                  <ul class="icons alt">
                    <li><a href="https://www.linkedin.com/in/victor-von-eisenhart-rothe/" class="icon brands fa-linkedin"><span class="label">Instagram</span></a></li>
                    <li><a href="https://github.com/Victorvone" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
                </div>
              </div>
            </section>
        </footer>

      <!-- Copyright -->
        <div id="copyright">
          <ul><li>Thanks for your time and interest! </li></ul>
        </div>
    </div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
